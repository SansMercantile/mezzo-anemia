# sans-mercantile-app/backend/mezzo_anima_line/Dockerfile
ARG repo_owner
FROM ghcr.io/${repo_owner}/python-base:latest

ENV PYTHONUNBUFFERED=1
ENV PYTHONDONTWRITEBYTECODE=1

WORKDIR /app

# --- ARG declarations for receiving secrets from GitHub Actions ---
ARG ACCESS_KEY_ID
ARG ALLOWED_ORIGINS
ARG ALPACA_BASE_URL
ARG ALPACA_PAPER_API_KEY_ID
ARG ALPACA_PAPER_SECRET_KEY
ARG ALPACA_SANDBOX_API_KEY_ID
ARG ALPACA_SANDBOX_SECRET_KEY
ARG ALPHA_VANTAGE_API
ARG AZURE_OPENAI_API_VERSION
ARG AZURE_OPENAI_DEPLOYMENT_NAME
ARG AZURE_OPENAI_ENDPOINT
ARG AZURE_OPENAI_KEY
ARG BINANCE_API_KEY
ARG BINANCE_BASE_URL
ARG BINANCE_SECRET_KEY
ARG BINANCE_WEBSOCKET_URL
ARG DB_NAME
ARG DB_PASS
ARG DB_USER
ARG DERIV_APP_CONSOLE_API_TOKEN
ARG DERIV_APP_CONSOLE_APP_ID
ARG DERIV_APP_NAME
ARG DERIV_PRIV1_API_TOKEN
ARG DERIV_PRIV1_APP_ID
ARG D_ID_API_KEY
ARG ENABLE_ALPACA_ADAPTER
ARG ENABLE_ALPACA_PAPER_ADAPTER
ARG ENABLE_ALPACA_SANDBOX_ADAPTER
ARG ENABLE_AZURE_OPENAI_ADAPTER
ARG ENABLE_DERIV_ADAPTER
ARG ENABLE_DERIV_APP_CONSOLE_ADAPTER
ARG ENABLE_DERIV_PRIV1_ADAPTER
ARG ENABLE_MOCK_ADAPTER
ARG ENABLE_MT5_ADAPTER
ARG EODHD_API_KEY
ARG EODHD_BASE_URL
ARG FBS_COMPANY_NAME_IN_MT
ARG FBS_DEMO_LOGIN_ID
ARG FBS_DEMO_PASSWORD
ARG FBS_DEMO_SEVER
ARG FBS_IB_LINK
ARG FBS_REAL_LOGIN_ID
ARG FBS_REAL_PASSWORD
ARG FBS_REAL_SEVER
ARG FINNHUB_API_KEY
ARG FINNHUB_SECRET
ARG GCP_PROJECT_ID
ARG GCP_REGION
ARG GEMINI_API_KEY
ARG GMAIL_SERVICE_ACCOUNT_SECRET_NAME
ARG INSTANCE_CONNECTION_NAME
ARG KILL_SWITCH_AI_TRADING
ARG LLM_MODEL_NAME
ARG MPETI_EMAIL_ADDRESS
ARG MT5_ACCOUNT
ARG MT5_PASSWORD
ARG MT5_SERVER
ARG NEWS_API_KEY_AI
ARG NEWS_API_KEY_ORG
ARG OPENAI_API_KEY
ARG POLYGON_ACCESS_KEY_ID
ARG POLYGON_API_KEY
ARG POLYGON_BUCKET
ARG POLYGON_NAME
ARG POLYGON_S3_ENDPOINT
ARG PUBLIC_IP_ADDRESS
ARG SECRET
ARG SIMFIN_API_KEY
ARG SIMFIN_BASE_URL
ARG TRADING_STRATEGY_MODE
ARG TWELVEDATA_API_KEY

COPY . /app

# Add the new library directory to the system's library path
ENV LD_LIBRARY_PATH=/app/lib:$LD_LIBRARY_PATH

CMD ["python", "anima_engine.py"]
